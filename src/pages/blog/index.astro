---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("blog"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---
<BaseLayout title="Blog" description="Blog posts">
  <div class="space-y-10">
    <h1 class="text-2xl font-semibold text-accent">Blog</h1>
    <ul class="space-y-6">
      {posts.length === 0 ? (
        <li class="text-muted">No posts yet.</li>
      ) : (
        posts.map((post) => (
          <li class="border-b border-border pb-6 last:border-0">
            <a href={`/blog/${post.slug}`} class="group block">
              <h2 class="font-medium text-accent group-hover:underline">{post.data.title}</h2>
              <p class="text-muted text-sm mt-1">{post.data.description}</p>
              <time class="text-muted text-sm mt-2 inline-block" datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString("en-US", { year: "numeric", month: "long", day: "numeric" })}
              </time>
            </a>
          </li>
        ))
      )}
    </ul>
  </div>
</BaseLayout>
