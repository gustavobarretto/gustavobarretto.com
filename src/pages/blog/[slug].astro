---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.filter((p) => !p.data.draft).map((p) => ({ params: { slug: p.slug }, props: { post: p } }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---
<BaseLayout title={post.data.title} description={post.data.description}>
  <article class="space-y-6">
    <header>
      <h1 class="text-2xl font-semibold text-accent">{post.data.title}</h1>
      <time class="text-muted text-sm" datetime={post.data.pubDate.toISOString()}>
        {post.data.pubDate.toLocaleDateString("en-US", { year: "numeric", month: "long", day: "numeric" })}
      </time>
    </header>
    <div class="prose prose-stone max-w-none prose-p:text-accent/90 prose-headings:text-accent prose-a:text-accent prose-a:underline">
      <Content />
    </div>
    <p class="pt-4">
      <a href="/blog" class="text-muted hover:text-accent text-sm">‚Üê Back to blog</a>
    </p>
  </article>
</BaseLayout>
